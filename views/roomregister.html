<!DOCTYPE html>
<html>
  <head>
    <title>KABANG :: Room Register</title>
    <link rel='stylesheet' href='/module/css/jquery-ui.min.css' />
    <link rel='stylesheet' href='/module/css/bootstrap.min.css' />
    <link rel='stylesheet' href='/module/font-awesome-4.7.0/css/font-awesome.min.css' />
    <link rel='stylesheet' href='/css/style.css' />
    <style type="text/css">

      input[type=file] {
          display: none;
      }

      .my_button {
          display: inline-block;
          width: 200px;
          text-align: center;
          padding: 10px;
          background-color: #006BCC;
          color: #fff;
          text-decoration: none;
          border-radius: 5px;
      }



      .imgs_wrap {

          border: 2px solid #A8A8A8;
          margin-top: 30px;
          margin-bottom: 30px;
          padding-top: 10px;
          padding-bottom: 10px;

      }
      .imgs_wrap img {
          max-width: 150px;
          margin-left: 10px;
          margin-right: 10px;
      }

  </style>
    <style type = "text/css">
      #map {
        width: 100%;
        height: 500px;
        background-color: grey;
      }
    </style>
  
  </head>
  <body>
          <form id ='registerAction' > 
          <div class = "form-group">
              <label for="Picture">Picture</label>
              <div class="input_wrap">
                  <input type="file" class= "form-control-file" id="input_imgs" multiple/>
              </div>
            </div>
        
            <div class = "form-group">
                <div class="imgs_wrap">
                    <img id="img" />
                </div>
            </div>  
            <button type="button" href="javascript:" onclick="fileUploadAction();" class="btn btn-primary">Upload</button>
          <div class="form-row">
              <div class="form-group col-md-6">
                <label for="Deposit">Deposit</label>
                <input type="text" class="form-control" id="deposit" placeholder="Deposit">
              </div>
              <div class="form-group col-md-6">  
                <label for="Monthly">Monthly</label>
                <input type="text" class="form-control" id="monthly" placeholder="Monthly">
              </div>
            </div>
              <div class="form-row">
                  <div class="form-group col-md-6">
                      <label for="Room type">Room type</label>
                      <select id="type" class="form-control">
                        <option selected>Room type</option>
                        <option value = "One-Room(반지하)">One-Room(반지하)</option>
                        <option value = "One-Room(지상)">One-Room(지상)</option>
                        <option value = "Two-Room">Two-Room</option>
                        <option value = "Three-Room">Three-Room</option>
                      </select>
                    </div>
                      <div class="form-group col-md-6">
                      <label for="Room status">Room status</label>
                      <select id="status" class="form-control">
                          <option selected>Room status</option>
                          <option value = "Empty">Empty</option>
                          <option value = "Will be empty">Will be empty</option>
                          <option value = "Remodeling">Remodeling</option>
                        </select>
                      </div>
                      </div>
                      <div id="map"></div>
                      <div class= "form-check">
                      <div id="cblist">
                        
                        <input type="checkbox" value="first checkbox" id="cb1" /> 
                        <label for="cb1">Option1</label>
                      </div>
                    </div>
                    <div class = "form-row">
                    <div class="form-group col-md-2">
                    <input class="form-control" type="text" placeholder="option" id="txtName">
                  </div>
                    <button type="button" class="btn btn-primary btn-sm" id = "btnSave">Add option</button>
                  </div>        
                  <div class="form-group">
                      <label for="Roomdescription">Room description</label>
                      <textarea class="form-control" id="description" rows="7"></textarea>
                    </div>
                    <div class="form-group row">
                        <div class="col-sm-10">
                          <button type="submit" class="btn btn-primary" id = 'register' >Register</button>
                        </div>
    </form>
    <script src="/module/js/jquery-1.12.4.min.js"></script>
    <script src="/module/js/jquery-ui.min.js"></script>
    <script src="/module/js/bootstrap.min.js"></script>
    <script src="/js/script.js"></script>
    <script type='text/javascript' src='./js/jquery/jquery-1.11.0.min.js'></script>
<script type="text/javascript"></script>
    <script>
      $(document).ready(function(){
      $("#add").on("click", function(){
        $("#dynamicCB").append("<br/><div class = 'form-check'><input class='form-check-input' type='radio' name= 'wifi' value ='Wifi'><label class = 'form-check-lable' for='wifi'>Wifi</label>")
      })});
      </script>
          <script>

            // $(document).ready(function() {
              

            // });
            
            
          </script>
          <script>
              var marker;
        
              function initMap() {
                var uluru = {lat: -25.363, lng: 131.044};
                var image = {
                  url: 'https://developers.google.com/maps/documentation/javascript/examples/full/images/beachflag.png',
                };
        
                var map = new google.maps.Map(document.getElementById('map'), {
                  zoom: 15,
                  center: uluru
                });
                
                marker = new google.maps.Marker({
                  map: map,
                  draggable: true,
                  animation: google.maps.Animation.DROP,
                  position: uluru,
                  title: 'uluru',
                  icon: image
                });
                       
                marker.addListener('click', toggleBounce); 
                
                var infoWindow = new google.maps.InfoWindow({map: map});
                if (navigator.geolocation) {
                  navigator.geolocation.getCurrentPosition(function(position) {
                    var pos = {
                      lat: position.coords.latitude,
                      lng: position.coords.longitude
                    };
        
                    infoWindow.setPosition(pos);
                    infoWindow.setContent('Location found. ');
                    map.setCenter (pos);
                    marker.setPosition (pos);
                  }, function () {
                    handleError (true, infoWindow, map.getCenter());
                  });
                } else {
                  //Browser does not support Geo
                  handleError (false, infoWindow, map.getCenter());
                }
        
              }
        
              function handleError (hasGeo, infoWindow, pos) {
                infoWindow.setPosition (pos);
                infoWindow.setContent(hasGeo ? 'Error: Geo service failed.':'Error: browser not support geo');
              }
        
              function toggleBounce() {
                if (marker.getAnimation() !== null) {
                  marker.setAnimation(null);
                } else {
                  marker.setAnimation(google.maps.Animation.BOUNCE);
                }
              }
            </script>
            <script async defer
            src="https://maps.googleapis.com/maps/api/js?key=AIzaSyBsBQPgeFw1k9z4NL7dFePLS7LmVyZidME&callback=initMap">
            </script>
            <script>
            
            </script>
            <script type="text/javascript" src="./js/jquery-3.1.0.min.js" charset="utf-8"></script>
            <script type="text/javascript">
        
                // 이미지 정보들을 담을 배열
                var sel_files = [];
                var index = 0;
                var fileNameArr = new Array();
        
        
                $(document).ready(function() {
                    $("#input_imgs").on("change", handleImgFileSelect);
                    $("#input_imgs").on("change", function(){
                      fileNameArr.push($('#input_imgs').val());
                    });
                }); 
        
                function fileUploadAction() {
                    console.log("fileUploadAction");
                    $("#input_imgs").trigger('click');
                }
        
                function handleImgFileSelect(e) {
        
                    // 이미지 정보들을 초기화
        
                    var files = e.target.files;
                    var filesArr = Array.prototype.slice.call(files);
                    
                    
                    filesArr.forEach(function(f) {
                        if(!f.type.match("image.*")) {
                            alert("확장자는 이미지 확장자만 가능합니다.");
                            return;
                        }
        
                        sel_files.push(f);
        
                        var reader = new FileReader();
                        reader.onload = function(e) {
                            var html = "<a href=\"javascript:void(0);\" onclick=\"deleteImageAction("+index+")\" id=\"img_id_"+index+"\"><img src=\"" + e.target.result + "\" data-file='"+f.name+"' class='selProductFile' title='Click to remove'></a>";
                            $(".imgs_wrap").append(html);
                            $(".imgs_wrap").append(index);
                            index++;
                        }
                        reader.readAsDataURL(f);
                        
                    });
                }
                $(document).ready(function() {
                  $('#btnSave').click(function() {
                      addCheckbox($('#txtName').val());
                  });
              });
              var optionNum;
              function addCheckbox(name) {
                 var container = $('#cblist');
                 var inputs = container.find('input');
                 optionNum = inputs.length+1;
              
                 $('<input />', { type: 'checkbox', id: 'cb'+ optionNum, value: name }).appendTo(container);
                 $('<label />', { 'for': 'cb'+ optionNum, text: name }).appendTo(container);
              }
              
              
              
              
              $(document).ready(function() {    
                $('#register').click(function(){
                var chkedArr = new Array;
                $("input:checkbox:checked").each(function(index){
                  chkedArr.push($(this).val());
                })
              
                    
                $.post('/register_room',{
                  deposit : $('#deposit').val(),
                  monthly : $('#monthly').val(),
                  status : $('#status').val(),
                  option : chkedArr,
                  description : $('#description').val(),
                  type : $('#type').val(), 
                  picture : fileNameArr},

                  function(result){
                  if(result){
                    alert("Register Success!!");
                  }
                  else{
                    alet("Register Faii!!");
                  }
                  });});}); 

            </script>
            
    </body>
    </html>

